!function(t){var e={};function i(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(s,n,function(e){return t[e]}.bind(null,n));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=2)}([function(t,e,i){"use strict";var s,n=this&&this.__extends||(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var s=Array(t),n=0;for(e=0;e<i;e++)for(var r=arguments[e],a=0,o=r.length;a<o;a++,n++)s[n]=r[a];return s};e.__esModule=!0;var a=i(1),o=[{img:"tile-0",0:[],1:[],2:[4],3:[],4:[2]},{img:"tile-1",0:[2],1:[3],2:[0],3:[1],4:[]},{img:"tile-2",0:[3],1:[2],2:[1],3:[0],4:[]},{img:"tile-3",0:[],1:[2],2:[1,3],3:[2],4:[]},{img:"tile-4",0:[2,3],1:[],2:[0],3:[0],4:[]},{img:"tile-5",0:[1,2],1:[0],2:[0],3:[],4:[]},{img:"tile-6",0:[],1:[2,3],2:[1,3],3:[1,2],4:[]},{img:"tile-7",0:[1],1:[0,3],2:[3],3:[1,2],4:[]},{img:"tile-8",0:[3],1:[2,3],2:[1],3:[0,1],4:[]},{img:"tile-9",0:[1,3],1:[0],2:[3],3:[0,2],4:[]},{img:"tile-10",0:[],1:[],2:[4],3:[],4:[2]}],l=function(t){function e(e,i,s,n,r,a){var l=t.call(this,e,i,s,o[n].img)||this;return e.add.existing(l),l.realAngle=l.angle,l.tileType=n,l.row=r||null,l.col=a||null,l}return n(e,t),e.prototype.sideToX=function(t){return 4===t?this.x+25*a.sideToColOffset(a.rotateSide(2,this.angle))*a.GRID_SCALE:this.x+70*a.sideToColOffset(t)*a.GRID_SCALE},e.prototype.sideToY=function(t){return 4===t?this.y+25*a.sideToRowOffset(a.rotateSide(2,this.angle))*a.GRID_SCALE:this.y+70*a.sideToRowOffset(t)*a.GRID_SCALE},e}(Phaser.GameObjects.Image);e.PathTile=l;var h=function(t){function e(e,i,s,n,r,a){var o=t.call(this,e,i,s,n,0)||this;return e.add.existing(o),o.onDownCallback=r,o.down=!1,o.disabled=a||!1,o.disabled&&o.setFrame(2),o.setInteractive(),o.on(Phaser.Input.Events.POINTER_DOWN,o.onDown,o),o.on(Phaser.Input.Events.POINTER_OUT,o.onOut,o),o.on(Phaser.Input.Events.POINTER_UP,o.onUp,o),o}return n(e,t),e.prototype.onOut=function(){this.disabled||this.setFrame(0),this.down=!1},e.prototype.onUp=function(){this.disabled||(this.setFrame(0),this.down&&this.onDownCallback())},e.prototype.onDown=function(){this.disabled||(this.setFrame(1),this.down=!0)},e}(Phaser.GameObjects.Image);function u(t,e,i){var s,n;return 4===i||4===e||2===Math.abs(i-e)?(s=Phaser.Math.Easing.Linear,n=Phaser.Math.Easing.Linear):1===e||3===e?(s=Phaser.Math.Easing.Sine.Out,n=Phaser.Math.Easing.Sine.In):(s=Phaser.Math.Easing.Sine.In,n=Phaser.Math.Easing.Sine.Out),[{duration:4===i||4===e?125:300,props:{x:t.sideToX(i)},ease:s},{duration:4===i||4===e?125:300,props:{y:t.sideToY(i)},ease:n}]}e.Button=h,e.makeXYTweens=u;var d=function(t){function e(e,i,s,n,r){var a=t.call(this,e,i.sideToX(s),i.sideToY(s),"ball")||this;return e.add.existing(a),a.tile=i,a.direction=s,a.visitedTiles=n,a.visitedDirections=r,a.crashed=!1,a.infiniteLoop=!1,a}return n(e,t),e.prototype.onPathComplete=function(){if(this.scene.ballFinished(this),this.crashed)this.anims.play("bye-ball");else if(this.infiniteLoop){var t=this.scene.add.image(this.x,this.y,"text-infinite-loop");this.scene.tweens.add({targets:t,duration:1e3,props:{y:this.y-50,alpha:0}}),this.setAlpha(0)}else if(this.tile){if(10===this.tile.tileType){var e=this.scene.add.image(this.x,this.y,"check");this.scene.tweens.add({targets:e,duration:300,props:{y:this.y-50}})}}else this.scene.tweens.add({targets:this,duration:2200,props:{x:this.x-1e3*a.sideToColOffset(this.direction),y:this.y-1e3*a.sideToRowOffset(this.direction)}})},e.prototype.go=function(){for(var t=[{ball:this,xTweens:[],yTweens:[]}];t.length>0;){var i=t.shift(),s=i.ball,n=i.xTweens,l=i.yTweens;t:for(;s.tile;){for(var h=0;h<s.visitedTiles.length;h++)if(s.visitedTiles[h]===s.tile&&s.visitedDirections[h]===s.direction){s.infiniteLoop=!0,s.tile=null;break t}s.visitedTiles.push(s.tile),s.visitedDirections.push(s.direction);var d=o[s.tile.tileType][a.rotateSide(s.direction,-s.tile.angle)];if(0===d.length&&(s.crashed=!0,s.tile=null),d.length>1){var g=a.rotateSide(d[1],s.tile.angle),c=s.direction,p=new e(this.scene,s.tile,s.direction,r(s.visitedTiles),r(s.visitedDirections));p.x=s.x,p.y=s.y;var f=u(s.tile,c,g),m=f[0],y=f[1];t.push({ball:p,xTweens:r(n,[m]),yTweens:r(l,[y])}),this.scene.balls.push(p);var b=s.tile.col+a.sideToColOffset(g),w=s.tile.row+a.sideToRowOffset(g);p.direction=a.rotateSide(g,180),p.tile=this.scene.grid[w][b]}if(d.length>0){g=a.rotateSide(d[0],s.tile.angle),c=s.direction;var x=u(s.tile,c,g);m=x[0],y=x[1];n.push(m),l.push(y);w=s.tile.row+a.sideToRowOffset(g),b=s.tile.col+a.sideToColOffset(g);if(s.direction=a.rotateSide(g,180),s.tile=this.scene.grid[w][b],4===g)break}}this.scene.tweens.timeline({tweens:n,targets:s,onComplete:s.onPathComplete,onCompleteScope:s}),this.scene.tweens.timeline({tweens:l,targets:s})}},e}(Phaser.GameObjects.Sprite);e.Ball=d},function(t,e,i){"use strict";e.__esModule=!0,e.GRID_SCALE=.55,e.GRID_X=125,e.GRID_Y=25,e.ctx=function(t){return 160*t*e.GRID_SCALE+e.GRID_X},e.rty=function(t){return 160*t*e.GRID_SCALE+e.GRID_Y},e.ytr=function(t){return Math.floor((t-(e.GRID_Y-160*e.GRID_SCALE*.5))/(160*e.GRID_SCALE))},e.xtc=function(t){return Math.floor((t-(e.GRID_X-160*e.GRID_SCALE*.5))/(160*e.GRID_SCALE))},e.rotateSide=function(t,e){return 4===t?4:((t+e/90)%4+4)%4},e.sideToColOffset=function(t){return{0:0,1:1,2:0,3:-1,4:0}[t]},e.sideToRowOffset=function(t){return{0:-1,1:0,2:1,3:0,4:0}[t]},e.drawFrom=function(t){var e=Math.floor(Math.random()*t.length);return t.splice(e,1)[0]}},function(t,e,i){"use strict";e.__esModule=!0;var s=i(3),n=i(4),r=i(5);new Phaser.Game({width:600,height:600,parent:"game",scene:[n.LoadScene,r.MenuScene,s.MainScene],scale:{mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH},backgroundColor:6111347})},function(t,e,i){"use strict";var s,n=this&&this.__extends||(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});e.__esModule=!0;var r=i(0),a=i(1),o=function(t){function e(){return t.call(this,"main")||this}return n(e,t),e.prototype.create=function(){this.difficulty=this.registry.get("difficulty")||5,this.lastRow=-1,this.lastCol=-1,this.freePlace=!0,this.pathsCompleted=0,this.ballsFinished=0,this.exitsReached=new Set,this.grid=[[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null]];var t=[[0,1],[0,2],[0,3],[1,0],[1,4],[2,0],[2,4],[3,0],[3,4],[4,1],[4,2],[4,3]],e=a.drawFrom(t),i=e[0],s=e[1];this.grid[i][s]=new r.PathTile(this,a.ctx(s),a.rty(i),0,i,s),this.grid[i][s].setScale(a.GRID_SCALE),4===s&&this.grid[i][s].setAngle(90),4===i&&this.grid[i][s].setAngle(180),0===s&&this.grid[i][s].setAngle(-90);for(var n=0;n<this.difficulty;n++){var o=a.drawFrom(t),l=o[0],h=o[1];this.grid[l][h]=new r.PathTile(this,a.ctx(h),a.rty(l),10,l,h),this.grid[l][h].setScale(a.GRID_SCALE),4===h&&this.grid[l][h].setAngle(90),4===l&&this.grid[l][h].setAngle(180),0===h&&this.grid[l][h].setAngle(-90)}this.spaces=[[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null]];for(var u=1;u<=3;u++)for(var d=1;d<=3;d++){var g=this.add.image(a.ctx(d),a.rty(u),"space");g.setScale(a.GRID_SCALE),g.setAlpha(.4),this.spaces[u][d]=g}this.preview=this.add.image(-500,-500,"tile-1"),this.preview.setScale(a.GRID_SCALE),this.preview.setAlpha(.4),this.tileDeck=[];for(n=1;n<=9;n++){var c=new r.PathTile(this,100+40*n,560,n);c.setScale(.2),this.tileDeck.push(c)}this.balls=[new r.Ball(this,this.grid[i][s],4,[],[])],this.input.removeAllListeners(),this.input.on(Phaser.Input.Events.POINTER_MOVE,this.onMove,this),this.input.on(Phaser.Input.Events.POINTER_DOWN,this.onClick,this),this.rotateRightButton=new r.Button(this,430,470,"rotate",this.rotateRight.bind(this)),this.rotateRightButton.setScale(.9),this.rotateLeftButton=new r.Button(this,170,470,"rotate",this.rotateLeft.bind(this)),this.rotateLeftButton.setScale(.9),this.rotateLeftButton.setFlipX(!0),this.shade=this.add.rectangle(300,300,600,600,0),this.shade.setAlpha(0),this.shade.setDepth(1),this.tutorialButton=new r.Button(this,560,40,"button-tutorial",this.toggleTutorial.bind(this)),this.tutorialButton.setDepth(2),this.tutorialText=this.add.image(300,335,"text-tutorial"),this.tutorialText.setAlpha(0),this.tutorialText.setDepth(2),this.endMenu=this.add.container(0,0),this.endMenu.setAlpha(0),this.endMenu.setDepth(2),this.pickNextTile()},e.prototype.ballFinished=function(t){this.ballsFinished+=1,t.tile&&10===t.tile.tileType&&this.exitsReached.add(t.tile),this.ballsFinished===this.balls.length&&this.time.addEvent({delay:1e3,callback:this.allFinished,callbackScope:this})},e.prototype.allFinished=function(){var t=this;this.shade.setAlpha(.8),this.endMenu.setAlpha(1);var e=this.registry.get("winStreak"),i=this.registry.get("bestStreak");if(this.exitsReached.size===this.difficulty?(this.endMenu.add(this.add.image(300,70,"text-win",a.drawFrom([0,1,2,3,4]))),this.registry.set("highestBeaten",Math.max(this.difficulty,this.registry.get("highestBeaten"))),5===this.difficulty&&(e+=1,i=Math.max(i,e))):(5===this.difficulty&&(e=0),this.endMenu.add(this.add.image(300,70,"text-loss",a.drawFrom([0,1,2,3,4])))),this.registry.set("winStreak",e),this.registry.set("bestStreak",i),localStorage.setItem("ninepath_data",JSON.stringify(this.registry.values)),this.endMenu.add([this.add.image(300,160,"text-play-again"),new r.Button(this,300,240,"button-beginner",(function(){t.registry.set("difficulty",2),t.scene.restart()})),new r.Button(this,300,310,"button-intermediate",(function(){t.registry.set("difficulty",3),t.scene.restart()}),this.registry.get("highestBeaten")<2),new r.Button(this,300,380,"button-expert",(function(){t.registry.set("difficulty",4),t.scene.restart()}),this.registry.get("highestBeaten")<3),new r.Button(this,300,450,"button-grandmaster",(function(){t.registry.set("difficulty",5),t.scene.restart()}),this.registry.get("highestBeaten")<4)]),i>0){var s=this.add.bitmapText(300,500,"words","grandmaster win streak: "+(i<=e?e:e+" (best: "+i+")"),72);s.setOrigin(.5,0),this.endMenu.add(s)}},e.prototype.toggleTutorial=function(){0===this.tutorialText.alpha?(this.tutorialText.setAlpha(1),this.shade.setAlpha(.8),this.tutorialButton.setTexture("button-x")):(this.tutorialText.setAlpha(0),this.shade.setAlpha(0),this.tutorialButton.setTexture("button-tutorial"))},e.prototype.onMove=function(t){var e=a.ytr(t.worldY),i=a.xtc(t.worldX);e>0&&e<4&&i>0&&i<4&&null===this.grid[e][i]&&(this.freePlace||e===this.lastRow||i===this.lastCol)?(this.preview.x=a.ctx(i),this.preview.y=a.rty(e)):(this.preview.x=-500,this.preview.y=-500)},e.prototype.onClick=function(t){if(1!==this.tutorialText.alpha){var e=a.ytr(t.downY),i=a.xtc(t.downX);if(e>0&&e<4&&i>0&&i<4&&null===this.grid[e][i]&&(this.freePlace||e===this.lastRow||i===this.lastCol)){this.preview.x=-500,this.preview.y=-500,this.nextTile.row=e,this.nextTile.col=i,this.grid[e][i]=this.nextTile,this.tweens.add({targets:this.nextTile,duration:200,props:{x:a.ctx(i),y:a.rty(e),scaleX:a.GRID_SCALE,scaleY:a.GRID_SCALE},onComplete:0===this.tileDeck.length?this.balls[0].go:null,onCompleteScope:this.balls[0]}),this.lastRow=e,this.lastCol=i,this.freePlace=!0;for(var s=1;s<=3;s++)for(var n=1;n<=3;n++)s!==e&&n!==i||null!==this.grid[s][n]?s===e&&n===i||this.spaces[s][n].setAlpha(.2):(this.spaces[s][n].setAlpha(.4),this.freePlace=!1);if(this.freePlace)for(s=1;s<=3;s++)for(n=1;n<=3;n++)this.spaces[s][n].setAlpha(.4);this.pickNextTile()}}},e.prototype.rotateRight=function(){1!==this.tutorialText.alpha&&(this.nextTile.setAngle(this.nextTile.realAngle),this.nextTile.realAngle+=90,this.preview.setAngle(this.nextTile.angle+90),this.tweens.add({targets:this.nextTile,duration:100,props:{angle:this.nextTile.angle+90}}))},e.prototype.rotateLeft=function(){1!==this.tutorialText.alpha&&(this.nextTile.setAngle(this.nextTile.realAngle),this.nextTile.realAngle-=90,this.preview.setAngle(this.nextTile.angle-90),this.tweens.add({targets:this.nextTile,duration:100,props:{angle:this.nextTile.angle-90}}))},e.prototype.pickNextTile=function(){this.tileDeck.length>0?(this.nextTile=a.drawFrom(this.tileDeck),this.preview.setTexture(this.nextTile.texture.key),this.preview.setAngle(this.nextTile.angle),this.tweens.add({targets:this.nextTile,duration:200,props:{x:300,y:470,scaleX:.8,scaleY:.8}})):(this.rotateRightButton.setAlpha(0),this.rotateLeftButton.setAlpha(0),this.tutorialButton.setAlpha(0))},e.prototype.tileAt=function(t,e){var i=Math.floor(t/140),s=Math.floor(e/140);return i>-1&&i<5&&s>-1&&s<5?this.grid[i][s]:null},e}(Phaser.Scene);e.MainScene=o},function(t,e,i){"use strict";var s,n=this&&this.__extends||(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});e.__esModule=!0;var r=function(t){function e(){return t.call(this,"load")||this}return n(e,t),e.prototype.preload=function(){this.load.image("tile-0","img/0.png"),this.load.image("tile-1","img/1.png"),this.load.image("tile-2","img/2.png"),this.load.image("tile-3","img/3.png"),this.load.image("tile-4","img/4.png"),this.load.image("tile-5","img/5.png"),this.load.image("tile-6","img/6.png"),this.load.image("tile-7","img/7.png"),this.load.image("tile-8","img/8.png"),this.load.image("tile-9","img/9.png"),this.load.image("tile-10","img/10.png"),this.load.image("select","img/select.png"),this.load.image("ball","img/ball.png"),this.load.image("space","img/space.png"),this.load.image("check","img/check.png"),this.load.image("logo","img/logo.png"),this.load.image("text-tutorial","img/text-tutorial.png"),this.load.image("text-by","img/text-by.png"),this.load.image("text-play-again","img/text-play-again.png"),this.load.image("text-infinite-loop","img/text-infinite-loop.png"),this.load.spritesheet("text-win","img/text-win.png",{frameWidth:444,frameHeight:65}),this.load.spritesheet("text-loss","img/text-loss.png",{frameWidth:444,frameHeight:65}),this.load.spritesheet("button-beginner","img/button-beginner.png",{frameWidth:152,frameHeight:50}),this.load.spritesheet("button-intermediate","img/button-intermediate.png",{frameWidth:184,frameHeight:50}),this.load.spritesheet("button-expert","img/button-expert.png",{frameWidth:119,frameHeight:50}),this.load.spritesheet("button-grandmaster","img/button-grandmaster.png",{frameWidth:190,frameHeight:50}),this.load.spritesheet("button-tutorial","img/button-tutorial.png",{frameWidth:40,frameHeight:40}),this.load.spritesheet("button-x","img/button-x.png",{frameWidth:40,frameHeight:40}),this.load.spritesheet("rotate","img/rotate.png",{frameWidth:70,frameHeight:70}),this.load.spritesheet("bye-ball","img/bye-ball.png",{frameWidth:70,frameHeight:70}),this.load.bitmapFont("words","font/words_0.png","font/words.fnt")},e.prototype.create=function(){this.anims.create({key:"bye-ball",frames:this.anims.generateFrameNumbers("bye-ball",{frames:[0,1,2,3,4,5,6,11]}),frameRate:30});var t,e=localStorage.getItem("ninepath_data");e?((t=JSON.parse(e)).highestBeaten||(t.highestBeaten=0),t.bestStreak||(t.bestStreak=0),t.winStreak||(t.winStreak=0)):(t={highestBeaten:0,winStreak:0,bestStreak:0},localStorage.setItem("ninepath_data",JSON.stringify(t))),this.registry.set(t,null),this.scene.start("menu")},e}(Phaser.Scene);e.LoadScene=r},function(t,e,i){"use strict";var s,n=this&&this.__extends||(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});e.__esModule=!0;var r=i(0),a=function(t){function e(){return t.call(this,"menu")||this}return n(e,t),e.prototype.create=function(){var t=this;this.add.image(300,75,"logo"),this.add.image(300,150,"text-by"),new r.Button(this,300,240,"button-beginner",(function(){t.registry.set("difficulty",2),t.scene.start("main")})),new r.Button(this,300,310,"button-intermediate",(function(){t.registry.set("difficulty",3),t.scene.start("main")}),this.registry.get("highestBeaten")<2),new r.Button(this,300,380,"button-expert",(function(){t.registry.set("difficulty",4),t.scene.start("main")}),this.registry.get("highestBeaten")<3),new r.Button(this,300,450,"button-grandmaster",(function(){t.registry.set("difficulty",5),t.scene.start("main")}),this.registry.get("highestBeaten")<4);var e=this.registry.get("winStreak"),i=this.registry.get("bestStreak");i>0&&this.add.bitmapText(300,500,"words","grandmaster win streak: "+(i<=e?e:e+" (best: "+i+")"),72).setOrigin(.5,0)},e}(Phaser.Scene);e.MenuScene=a}]);